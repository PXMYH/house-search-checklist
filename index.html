<!DOCTYPE html>
<html>
  <head>
    <title>Dynamic Checklist</title>

    <style>
      .checklist-item {
        display: flex;
        align-items: center;
        margin-bottom: 20px; /* Add margin to create spacing between checklist items */
      }
      .circle-container {
        display: flex;
        flex-direction: row; /* Display circles horizontally */
      }
      .circle {
        width: 30px;
        height: 30px;
        border: 2px solid black; /* Add a black border to create the circle */
        border-radius: 50%;
        background-color: white; /* Set background color to white */
        cursor: pointer;
        margin-right: 10px; /* Add margin to separate circles */
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        color: black; /* Set text color to black */
        transition: background-color 0.3s, color 0.3s; /* Add a transition for smoother color change */
      }
      .selected {
        background-color: green; /* Set background color to green when selected */
        color: white; /* Set text color to white when selected */
      }
    </style>
  </head>

  <body>
    <h1>House Search Checklist</h1>

    <!-- Add a house address input field -->
    <label for="houseAddress">House Address:</label>
    <input type="text" id="houseAddress" />

    <div class="checklist"></div>

    <!-- Add a Submit button -->
    <button id="submitBtn">Submit</button>

    <script>
      // Checklist data
      const checklistItems = [
        {
          title: 'Location',
          maxRating: 5,
        },
        {
          title: 'Price',
          maxRating: 5,
        },
      ];

      // Render function
      function renderChecklist() {
        // Clear checklist
        document.querySelector('.checklist').innerHTML = '';

        // Loop through data
        checklistItems.forEach((item) => {
          // Create item div
          console.log('creating div for checklist');
          const checklistItem = document.createElement('div');
          checklistItem.classList.add('checklist-item');

          // Create title
          const title = document.createElement('span');
          title.textContent = item.title;

          // Create ratings container
          const ratingsContainer = document.createElement('div');
          ratingsContainer.classList.add('circle-container');

          // Create rating circles
          for (let i = 1; i <= item.maxRating; i++) {
            const ratingCircle = document.createElement('div');
            ratingCircle.classList.add('circle');
            ratingCircle.dataset.rating = i;
            ratingCircle.textContent = i;
            ratingsContainer.appendChild(ratingCircle);
          }

          // Append elements
          checklistItem.appendChild(title);
          checklistItem.appendChild(ratingsContainer);

          // Append item to checklist
          document.querySelector('.checklist').appendChild(checklistItem);
        });
      }

      // Initial render
      renderChecklist();

      // Rerender on data change
      // checklistItems.forEach((item) => {
      //   item.addEventListener('change', renderChecklist);
      // });

      const circles = document.querySelectorAll('.circle');

      circles.forEach((circle) => {
        circle.addEventListener('click', () => {
          // Get the parent checklist container
          const checklistContainer = circle
            .closest('.checklist-item')
            .querySelector('.circle-container');

          // Deselect all circles in the same checklist item
          checklistContainer
            .querySelectorAll('.circle')
            .forEach((innerCircle) => {
              if (innerCircle !== circle) {
                innerCircle.classList.remove('selected');
              }
            });

          // Toggle the selected state of the clicked circle
          circle.classList.toggle('selected');
        });
      });

      // Add functionality for the Submit button
      const submitButton = document.getElementById('submitBtn');
      submitButton.addEventListener('click', () => {
        const houseAddress = document.getElementById('houseAddress').value;
        if (houseAddress) {
          // Create a file with the house name as the filename and ".txt" as the suffix
          const fileName = `${houseAddress}.txt`;

          // You can write data to the file here or perform any desired action
          // For example, you can create a Blob and trigger a download

          const data = 'This is some example data for the file.';
          const blob = new Blob([data], { type: 'text/plain' });
          const url = window.URL.createObjectURL(blob);

          const a = document.createElement('a');
          a.href = url;
          a.download = fileName;
          document.body.appendChild(a);
          a.click();

          window.URL.revokeObjectURL(url);
        } else {
          alert('Please enter a house address before submitting.');
        }
      });
    </script>
  </body>
</html>
