<!DOCTYPE html>
<html>
  <head>
    <title>Dynamic Checklist</title>
    <style>
      .checklist-item {
        display: flex;
        align-items: center;
        margin-bottom: 20px; /* Add margin to create spacing between checklist items */
      }
      .circle-container {
        display: flex;
        flex-direction: row; /* Display circles horizontally */
      }
      .circle {
        width: 30px;
        height: 30px;
        border: 2px solid black; /* Add a black border to create the circle */
        border-radius: 50%;
        background-color: white; /* Set background color to white */
        cursor: pointer;
        margin-right: 10px; /* Add margin to separate circles */
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        color: black; /* Set text color to black */
        transition: background-color 0.3s, color 0.3s; /* Add a transition for smoother color change */
      }
      .selected {
        background-color: green; /* Set background color to green when selected */
        color: white; /* Set text color to white when selected */
      }
      table {
        border-collapse: collapse;
        width: 100%;
        margin-top: 20px;
      }

      th,
      td {
        border: 1px solid black;
        padding: 8px;
        text-align: left;
      }

      th {
        background-color: #f2f2f2;
      }
    </style>
  </head>
  <body>
    <h1>House Search Checklist</h1>

    <!-- Add a house address input field -->
    <label for="houseAddress">House Address:</label>
    <input type="text" id="houseAddress" />

    <div class="checklist"></div>

    <!-- Add a Submit button above the table -->
    <button id="submitBtn">Submit</button>

    <!-- Display checklist responses as a table with column names -->
    <table id="responseTable">
      <thead>
        <tr>
          <th>Address</th>
          <!-- Add checklist item columns dynamically -->
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      // Checklist data
      const checklistItems = [
        {
          title: 'Location',
          maxRating: 5,
        },
        {
          title: 'Price',
          maxRating: 5,
        },
        {
          title: 'Nature Light',
          maxRating: 5,
        },
        {
          title: 'Space',
          maxRating: 5,
        },
        {
          title: 'Ceiling Height',
          maxRating: 5,
        },
        {
          title: 'Floor noise',
          maxRating: 5,
        },
        {
          title: 'Smell',
          maxRating: 5,
        },
        {
          title: 'Bedroom facing',
          maxRating: 5,
        },
      ];

      // Dictionary to store checklist responses
      let checklistResponses = {};

      // Render function
      function renderChecklist() {
        // Clear checklist
        document.querySelector('.checklist').innerHTML = '';

        // Loop through data
        checklistItems.forEach((item) => {
          // Create item div
          const checklistItem = document.createElement('div');
          checklistItem.classList.add('checklist-item');

          // Create title
          const title = document.createElement('span');
          title.textContent = item.title;

          // Create ratings container
          const ratingsContainer = document.createElement('div');
          ratingsContainer.classList.add('circle-container');

          // Create rating circles
          for (let i = 1; i <= item.maxRating; i++) {
            const ratingCircle = document.createElement('div');
            ratingCircle.classList.add('circle');
            ratingCircle.dataset.rating = i;
            ratingCircle.textContent = i;
            ratingsContainer.appendChild(ratingCircle);
          }

          // Append elements
          checklistItem.appendChild(title);
          checklistItem.appendChild(ratingsContainer);

          // Append item to checklist
          document.querySelector('.checklist').appendChild(checklistItem);
        });

        // Update the response table with column names
        updateResponseTableHeaders();

        // Load stored data from localStorage
        loadStoredData();
      }

      // Initial render
      renderChecklist();

      const circles = document.querySelectorAll('.circle');

      circles.forEach((circle) => {
        circle.addEventListener('click', () => {
          // Get the parent checklist container
          const checklistContainer = circle
            .closest('.checklist-item')
            .querySelector('.circle-container');

          // Deselect all circles in the same checklist item
          checklistContainer
            .querySelectorAll('.circle')
            .forEach((innerCircle) => {
              if (innerCircle !== circle) {
                innerCircle.classList.remove('selected');
              }
            });

          // Toggle the selected state of the clicked circle
          circle.classList.toggle('selected');

          // Get checklist item and response
          const checklistItem = circle
            .closest('.checklist-item')
            .querySelector('span').textContent;
          const response = circle.classList.contains('selected')
            ? circle.dataset.rating
            : '';

          // Update or add the response to the dictionary
          checklistResponses[checklistItem] = response;

          // Save the updated response data to localStorage
          saveDataToLocalStorage();
        });
      });

      // Add functionality for the Submit button
      const submitButton = document.getElementById('submitBtn');
      submitButton.addEventListener('click', () => {
        const houseAddressInput = document.getElementById('houseAddress');
        const houseAddress = houseAddressInput.value;
        if (houseAddress) {
          // Add the house address as the key to the dictionary
          checklistResponses['Address'] = houseAddress;

          // Clear the address input
          houseAddressInput.value = '';

          // Update the response table when clicking the Submit button
          updateResponseTable();

          // Save the updated response data to localStorage
          saveDataToLocalStorage();
        } else {
          alert('Please enter a house address before submitting.');
        }
      });

      // Function to update the response table with column names
      function updateResponseTableHeaders() {
        const table = document.querySelector('#responseTable');
        const tableHead = table.querySelector('thead');

        // Clear existing columns
        tableHead.innerHTML = '';

        // Create a column for the address
        const addressHeader = document.createElement('th');
        addressHeader.textContent = 'Address';
        tableHead.appendChild(addressHeader);

        // Loop through checklist items and create columns
        checklistItems.forEach((item) => {
          const itemHeader = document.createElement('th');
          itemHeader.textContent = item.title;
          tableHead.appendChild(itemHeader);
        });
      }

      // Function to update the response table
      function updateResponseTable() {
        const table = document.querySelector('#responseTable');
        const tableBody = table.querySelector('tbody');
        const row = document.createElement('tr');

        // Create a cell for the address
        const addressCell = document.createElement('td');
        addressCell.textContent = checklistResponses['Address'];
        row.appendChild(addressCell);

        // Loop through checklist items and create columns
        checklistItems.forEach((item) => {
          const itemResponse = checklistResponses[item.title];
          const itemResponseCell = document.createElement('td');
          itemResponseCell.textContent = itemResponse;
          row.appendChild(itemResponseCell);
        });

        tableBody.appendChild(row);
      }

      // Function to load stored data from localStorage
      function loadStoredData() {
        const storedData = localStorage.getItem('checklistResponses');
        if (storedData) {
          checklistResponses = JSON.parse(storedData);

          // Update the response table UI with the retrieved data
          updateResponseTable();
        }
      }

      // Function to save response data to localStorage
      function saveDataToLocalStorage() {
        localStorage.setItem(
          'checklistResponses',
          JSON.stringify(checklistResponses)
        );
      }
    </script>
  </body>
</html>
